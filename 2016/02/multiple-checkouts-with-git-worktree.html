<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Multiple Checkouts With Git Worktree</title>

  <meta name="description" content="Manage multiple Git checkouts with the worktree command">

  <link rel="stylesheet" href="/css/main.min.css">

  <link rel="icon" href="data:;base64,iVBORw0KGgo=">

  <link rel="canonical" href="https://www.renyard.co.uk/2016/02/multiple-checkouts-with-git-worktree.html">
  <link rel="alternate" type="application/rss+xml" title="Ian Renyard" href="https://www.renyard.co.uk/feed.xml">
</head>

<header class="container">

  <nav class="navbar navbar-full navbar-dark bg-inverse">
    <a class="navbar-brand" href="/">Ian Renyard</a>

    <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#navCollapse">
      &#9776;
    </button>
    <ul class="nav navbar-nav collapse navbar-toggleable-xs" id="navCollapse">
      
        
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">Blog</a>
          </li>
        
      
        
      
        
      
        
          <li class="nav-item active">
            <a class="nav-link" href="/projects/">Side Projects</a>
          </li>
        
      
      
    </ul>
  </nav>

</header>


<article class="post container" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <div class="postimage" style="background-image: url(/images/background/tree.jpg);"></div>
    
    <h1 class="post-title" itemprop="name headline">Multiple Checkouts With Git Worktree</h1>
    <p class="post-meta"><time datetime="2016-02-05T00:00:00+00:00" itemprop="datePublished">Feb 5, 2016</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ian Renyard</span></span> • <a href="https://www.renyard.co.uk/2016/02/multiple-checkouts-with-git-worktree.html#disqus_thread">Comments</a></p>

    <a href="https://twitter.com/share" class="twitter-share-button" data-via="renyard">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script> 

    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.5";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
    <div class="fb-share-button" data-href="https://developers.facebook.com/docs/plugins/" data-layout="button"></div>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>I regularly find the need to switch branches in my local Git repos for code reviews or to work on another feature or bug within a project. In the past, I would have either cloned a new copy of the repo or stashed any changes which were not ready to commit. Neither of these is ideal as a new copy is wasteful, as checking out a large repo can take a while and stashing changes is quite disruptive to your current context.</p>

<h2 id="worktree">Worktree</h2>

<p>Git 2.5 introduced the <code class="highlighter-rouge">worktree</code> command, which can be used to checkout multiple working trees from the same local repo. In short this gives you as many different branches as you like checked out to multiple directories at the same time, all pointing to the same local Git repo. This means no wasting disk space on multiple copies of Git meta data and best of all, each worktree is instantly aware of any changes committed from another worktree.</p>

<h3 id="usage">Usage</h3>

<h4 id="code-reviews">Code Reviews</h4>

<p>For this example, let’s assume the original checkout is on a feature branch that I’m working on and a colleague asks me to review a feature before it’s merged.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git worktree add newfeature -b newfeature origin/newfeature
</code></pre></div></div>

<p>This will create a new directory <code class="highlighter-rouge">newfeature</code> in the root of the existing repo, containing the <code class="highlighter-rouge">newfeature</code> branch from origin. At this point, the new feature can be reviewed without loosing the context of the <code class="highlighter-rouge">develop</code> branch or even any open files.</p>

<p>Once the review is complete, the <code class="highlighter-rouge">newfeature</code> directory can be deleted and the worktree pruned:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rm -rf newfeature
$ git worktree prune
</code></pre></div></div>

<h4 id="bug-fixing">Bug Fixing</h4>

<p>For me, the other major use case of the <code class="highlighter-rouge">worktree</code> command is for bug fixing. In the following example, the original checkout is on a feature branch and we want to start a new branch for a bugfix:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git worktree add bugfix -b bugfix develop
$ cd bugfix
</code></pre></div></div>

<p>In this command, a new directory called <code class="highlighter-rouge">bugfix</code> is created on a new branch with the same name. The last parameter tells Git to base the new branch on the existing <code class="highlighter-rouge">develop</code> branch.</p>

<p>We then cd into the bugfix directory and can implement the bug fix. Once the bugfix is committed, the branch is ready to be merged back to <code class="highlighter-rouge">develop</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git commit -a
$ git checkout develop
$ git merge bugfix
</code></pre></div></div>

<p>The worktree can then be removed and the branch deleted:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git branch -d bugfix
$ cd ../
$ rm -rf bugfix
$ git worktree prune
</code></pre></div></div>

<p>At the time of writing, <code class="highlighter-rouge">worktree</code> is still quite new and as such is considered experimental. It also does not yet support the full functionality of Git, such as <code class="highlighter-rouge">submodules</code>, in multiple checkouts and the <a href="https://git-scm.com/docs/git-worktree/2.7.0#_bugs">documentation suggests a few features which could be added in the future</a>.</p>

<p>Even with the above limitations, <code class="highlighter-rouge">worktree</code> can be useful when a quick fix needs to be made or for reviewing another branch.</p>

  </div>

  <div id="disqus_thread"></div>
<script>
var disqus_config = function () {
  this.page.url = 'https://www.renyard.co.uk/2016/02/multiple-checkouts-with-git-worktree.html'; // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = '/2016/02/multiple-checkouts-with-git-worktree'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//renyard.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</article>


<footer class="container">
<nav class="navbar navbar-full navbar-dark bg-inverse">
  <ul class="nav navbar-nav">
    <li class="nav-item">
      <a class="nav-link" href="https://github.com/renyard">
        <span class="fa fa-github"></span>
        GitHub
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="https://www.linkedin.com/in/renyard">
        <span class="fa fa-linkedin"></span>
        LinkedIn
      </a>
    </li>
  </ul>
</nav>
</footer>

<script>
  // Bootstrap tooltips require Tether and Bootstrap errors on load without it.
  // Stub window.Tether to prevent the error.
  window.Tether = function() {};
</script>

<script src="/js/lib.min.js"></script>


<script id="dsq-count-scr" src="//renyard.disqus.com/count.js" async></script>
